{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Shbaita Studio\\\\Documents\\\\project\\\\new1\\\\themeforest-irsnufCS-redparts-auto-parts-react-ecommerce-template\\\\Sources\\\\src\\\\components\\\\header\\\\Search.tsx\";\nvar __jsx = React.createElement;\n// react\nimport React, { useRef, useState } from 'react'; // third-party\n\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport classNames from 'classnames'; // application\n\nimport AppImage from '~/components/shared/AppImage';\nimport AppLink from '~/components/shared/AppLink';\nimport AsyncAction from '~/components/shared/AsyncAction';\nimport CurrencyFormat from '~/components/shared/CurrencyFormat';\nimport RadioButton from '~/components/shared/RadioButton';\nimport Rating from '~/components/shared/Rating';\nimport url from '~/services/url';\nimport VehicleForm from '~/components/shared/VehicleForm';\nimport { Car20Svg, RecycleBin16Svg, Search20Svg } from '~/svg';\nimport { shopApi } from '~/api';\nimport { useGlobalMousedown } from '~/services/hooks';\nimport { useGarageAddItem, useGarageCurrent, useGarageRemoveItem, useGarageSetCurrent, useUserVehicles } from '~/store/garage/garageHooks';\nexport function Search() {\n  const intl = useIntl();\n  const {\n    0: query,\n    1: setQuery\n  } = useState('');\n  const {\n    0: suggestionsIsOpen,\n    1: setSuggestionsIsOpen\n  } = useState(false);\n  const {\n    0: hasSuggestions,\n    1: setHasSuggestions\n  } = useState(false);\n  const {\n    0: products,\n    1: setProducts\n  } = useState([]);\n  const {\n    0: categories,\n    1: setCategories\n  } = useState([]);\n  const {\n    0: vehiclePickerIsOpen,\n    1: setVehiclePickerIsOpen\n  } = useState(false);\n  const {\n    0: vehiclePanel,\n    1: setVehiclePanel\n  } = useState('list');\n  const {\n    0: addVehicle,\n    1: setAddVehicle\n  } = useState(null);\n  const vehicles = useUserVehicles();\n  const garageAddItem = useGarageAddItem();\n  const garageRemoveItem = useGarageRemoveItem();\n  const hasVehicles = vehicles.length > 0;\n  const selectVehicleButtonRef = useRef(null);\n  const vehiclePickerDropdownRef = useRef(null);\n  const currentVehicle = useGarageCurrent();\n  const garageSetCurrent = useGarageSetCurrent();\n  const searchCancelFnRef = useRef(() => {});\n  const rootRef = useRef(null);\n\n  const search = value => {\n    searchCancelFnRef.current();\n    let canceled = false;\n\n    searchCancelFnRef.current = () => {\n      canceled = true;\n    };\n\n    shopApi.getSearchSuggestions(value, {\n      limitProducts: 3,\n      limitCategories: 4\n    }).then(result => {\n      if (canceled) {\n        return;\n      }\n\n      if (result.products.length === 0 && result.categories.length === 0) {\n        setHasSuggestions(false);\n        return;\n      }\n\n      setHasSuggestions(true);\n      setProducts(result.products);\n      setCategories(result.categories);\n    });\n    setQuery(value);\n  };\n\n  const toggleSuggestions = force => {\n    setSuggestionsIsOpen(prevState => {\n      const newState = force !== undefined ? force : !prevState;\n\n      if (newState) {\n        setVehiclePickerIsOpen(false);\n      }\n\n      return newState;\n    });\n  };\n\n  const toggleVehiclePicker = force => {\n    setVehiclePickerIsOpen(prevState => {\n      const newState = force !== undefined ? force : !prevState;\n\n      if (newState) {\n        setSuggestionsIsOpen(false);\n      }\n\n      return newState;\n    });\n  };\n\n  const handleInputFocus = event => {\n    const input = event.currentTarget;\n    toggleSuggestions(true);\n    search(input.value);\n  };\n\n  const handleInputChange = event => {\n    const input = event.currentTarget;\n    search(input.value);\n  };\n\n  const handleButtonClick = () => {\n    toggleVehiclePicker();\n  };\n\n  const handleChangeCurrentVehicle = event => {\n    const vehicleId = event.currentTarget.value === '' ? null : parseFloat(event.currentTarget.value);\n    garageSetCurrent(vehicleId);\n  };\n\n  const handleVehicleChange = vehicle => {\n    setAddVehicle(vehicle);\n  };\n\n  const handleRootBlur = () => {\n    setTimeout(() => {\n      if (document.activeElement === document.body) {\n        return;\n      } // Close suggestions if the focus received an external element.\n\n\n      if (document.activeElement && document.activeElement.closest('.search') !== rootRef.current) {\n        toggleSuggestions(false);\n      }\n    }, 10);\n  };\n\n  useGlobalMousedown(event => {\n    const outsideButton = selectVehicleButtonRef.current && !selectVehicleButtonRef.current.contains(event.target);\n    const outsideDropdown = vehiclePickerDropdownRef.current && !vehiclePickerDropdownRef.current.contains(event.target);\n\n    if (outsideButton && outsideDropdown) {\n      setVehiclePickerIsOpen(false);\n    }\n  }, [setVehiclePickerIsOpen, selectVehicleButtonRef]);\n  useGlobalMousedown(event => {\n    const outside = rootRef.current && !rootRef.current.contains(event.target);\n\n    if (outside && suggestionsIsOpen) {\n      setHasSuggestions(false);\n    }\n  }, [rootRef, suggestionsIsOpen, setHasSuggestions]);\n  const searchPlaceholder = currentVehicle ? intl.formatMessage({\n    id: 'INPUT_SEARCH_PLACEHOLDER_VEHICLE'\n  }, currentVehicle) : intl.formatMessage({\n    id: 'INPUT_SEARCH_PLACEHOLDER'\n  });\n  return __jsx(\"div\", {\n    className: \"search\",\n    ref: rootRef,\n    onBlur: handleRootBlur,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 9\n    }\n  }, __jsx(\"form\", {\n    className: \"search__body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"search__shadow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 17\n    }\n  }), __jsx(\"label\", {\n    className: \"sr-only\",\n    htmlFor: \"site-search\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"INPUT_SEARCH_LABEL\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 21\n    }\n  })), __jsx(\"input\", {\n    type: \"text\",\n    className: \"search__input\",\n    id: \"site-search\",\n    autoCapitalize: \"off\",\n    autoComplete: \"off\",\n    spellCheck: \"false\",\n    name: \"search\",\n    value: query,\n    placeholder: searchPlaceholder,\n    onFocus: handleInputFocus,\n    onChange: handleInputChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 17\n    }\n  }), __jsx(\"button\", {\n    type: \"button\",\n    className: classNames('search__button search__button--start', {\n      'search__button--hover': vehiclePickerIsOpen\n    }),\n    onClick: handleButtonClick,\n    ref: selectVehicleButtonRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 17\n    }\n  }, __jsx(\"span\", {\n    className: \"search__button-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 21\n    }\n  }, __jsx(Car20Svg, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 25\n    }\n  })), __jsx(\"span\", {\n    className: \"search__button-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 21\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"BUTTON_SEARCH_SELECT_VEHICLE_DESKTOP\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 25\n    }\n  }))), __jsx(\"button\", {\n    className: \"search__button search__button--end\",\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 17\n    }\n  }, __jsx(\"span\", {\n    className: \"search__button-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 21\n    }\n  }, __jsx(Search20Svg, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 25\n    }\n  }))), __jsx(\"div\", {\n    className: \"search__box\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 17\n    }\n  }), __jsx(\"div\", {\n    className: \"search__decor\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"search__decor-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 21\n    }\n  }), __jsx(\"div\", {\n    className: \"search__decor-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    className: classNames('search__dropdown', 'search__dropdown--suggestions', 'suggestions', {\n      'search__dropdown--open': suggestionsIsOpen && hasSuggestions\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 17\n    }\n  }, products.length > 0 && __jsx(\"div\", {\n    className: \"suggestions__group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 25\n    }\n  }, __jsx(\"div\", {\n    className: \"suggestions__group-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 29\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"TEXT_PRODUCTS\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 33\n    }\n  })), __jsx(\"div\", {\n    className: \"suggestions__group-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 29\n    }\n  }, products.map(product => __jsx(AppLink, {\n    key: product.id,\n    href: url.product(product),\n    className: \"suggestions__item suggestions__product\",\n    onClick: () => toggleSuggestions(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 37\n    }\n  }, __jsx(\"div\", {\n    className: \"suggestions__product-image\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 41\n    }\n  }, __jsx(AppImage, {\n    src: product.images && product.images[0],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 45\n    }\n  })), __jsx(\"div\", {\n    className: \"suggestions__product-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 41\n    }\n  }, __jsx(\"div\", {\n    className: \"suggestions__product-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 45\n    }\n  }, product.name), __jsx(\"div\", {\n    className: \"suggestions__product-rating\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 45\n    }\n  }, __jsx(\"div\", {\n    className: \"suggestions__product-rating-stars\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 49\n    }\n  }, __jsx(Rating, {\n    value: product.rating || 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 53\n    }\n  })), __jsx(\"div\", {\n    className: \"suggestions__product-rating-label\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 49\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"TEXT_RATING_LABEL\",\n    values: {\n      rating: product.rating,\n      reviews: product.reviews\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 53\n    }\n  })))), __jsx(\"div\", {\n    className: \" suggestions__product-price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 41\n    }\n  }, __jsx(CurrencyFormat, {\n    value: product.price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 45\n    }\n  })))))), categories.length > 0 && __jsx(\"div\", {\n    className: \"suggestions__group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 25\n    }\n  }, __jsx(\"div\", {\n    className: \"suggestions__group-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 29\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"TEXT_CATEGORIES\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 33\n    }\n  })), __jsx(\"div\", {\n    className: \"suggestions__group-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 29\n    }\n  }, categories.map(category => __jsx(AppLink, {\n    key: category.id,\n    href: url.category(category),\n    className: \"suggestions__item suggestions__category\",\n    onClick: () => toggleSuggestions(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 37\n    }\n  }, category.name))))), __jsx(\"div\", {\n    className: classNames('search__dropdown', 'search__dropdown--vehicle-picker', 'vehicle-picker', {\n      'search__dropdown--open': vehiclePickerIsOpen\n    }),\n    ref: vehiclePickerDropdownRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"search__dropdown-arrow\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 21\n    }\n  }), __jsx(\"div\", {\n    className: classNames('vehicle-picker__panel', {\n      'vehicle-picker__panel--active': vehiclePanel === 'list' && hasVehicles\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: \"vehicle-picker__panel-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 25\n    }\n  }, __jsx(\"div\", {\n    className: \"vehicle-picker__text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 29\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"TEXT_SELECT_VEHICLE_TO_FIND_EXACT_FIT_PARTS\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 33\n    }\n  })), __jsx(\"div\", {\n    className: \"vehicles-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 29\n    }\n  }, __jsx(\"div\", {\n    className: \"vehicles-list__body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 33\n    }\n  }, __jsx(\"label\", {\n    className: \"vehicles-list__item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 37\n    }\n  }, __jsx(RadioButton, {\n    className: \"vehicles-list__item-radio\",\n    name: \"header-current-vehicle\",\n    defaultValue: \"\",\n    checked: currentVehicle === null,\n    onChange: handleChangeCurrentVehicle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 41\n    }\n  }), __jsx(\"span\", {\n    className: \" vehicles-list__item-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 41\n    }\n  }, __jsx(\"span\", {\n    className: \" vehicles-list__item-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 45\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"TEXT_ALL_VEHICLES\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 49\n    }\n  })))), vehicles.map((vehicle, index) => __jsx(React.Fragment, {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 41\n    }\n  }, __jsx(\"label\", {\n    className: \"vehicles-list__item\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 45\n    }\n  }, __jsx(RadioButton, {\n    className: \"vehicles-list__item-radio\",\n    name: \"header-current-vehicle\",\n    defaultValue: vehicle.id,\n    checked: (currentVehicle === null || currentVehicle === void 0 ? void 0 : currentVehicle.id) === vehicle.id,\n    onChange: handleChangeCurrentVehicle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 49\n    }\n  }), __jsx(\"span\", {\n    className: \"vehicles-list__item-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 49\n    }\n  }, __jsx(\"span\", {\n    className: \"vehicles-list__item-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 53\n    }\n  }, `${vehicle.year} ${vehicle.make} ${vehicle.model}`), __jsx(\"span\", {\n    className: \"vehicles-list__item-details\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 53\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"TEXT_VEHICLE_ENGINE\",\n    values: {\n      engine: vehicle.engine\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 57\n    }\n  }))), __jsx(AsyncAction, {\n    action: () => garageRemoveItem(vehicle.id),\n    render: ({\n      run,\n      loading\n    }) => __jsx(\"button\", {\n      type: \"button\",\n      className: classNames('vehicles-list__item-remove', {\n        'vehicles-list__item-remove--loading': loading\n      }),\n      onClick: run,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 57\n      }\n    }, __jsx(RecycleBin16Svg, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 61\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 49\n    }\n  })))))), __jsx(\"div\", {\n    className: \"vehicle-picker__actions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 29\n    }\n  }, __jsx(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-sm\",\n    onClick: () => setVehiclePanel('form'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 33\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"BUTTON_ADD_VEHICLE\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 37\n    }\n  }))))), __jsx(\"div\", {\n    className: classNames('vehicle-picker__panel', {\n      'vehicle-picker__panel--active': vehiclePanel === 'form' || !hasVehicles\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: \"vehicle-picker__panel-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 25\n    }\n  }, __jsx(VehicleForm, {\n    location: \"search\",\n    onVehicleChange: handleVehicleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 29\n    }\n  }), __jsx(\"div\", {\n    className: \"vehicle-picker__actions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 29\n    }\n  }, hasVehicles && __jsx(\"div\", {\n    className: \"search__car-selector-link\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 37\n    }\n  }, __jsx(AppLink, {\n    anchor: true,\n    onClick: event => {\n      event.preventDefault();\n      setVehiclePanel('list');\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 41\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"BUTTON_BACK_TO_LIST\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 45\n    }\n  }))), __jsx(AsyncAction, {\n    action: () => addVehicle ? garageAddItem(addVehicle.id) : Promise.resolve(),\n    render: ({\n      run,\n      loading\n    }) => __jsx(\"button\", {\n      type: \"button\",\n      className: classNames('btn', 'btn-primary', 'btn-sm', {\n        'btn-loading': loading\n      }),\n      disabled: addVehicle === null,\n      onClick: run,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 413,\n        columnNumber: 41\n      }\n    }, __jsx(FormattedMessage, {\n      id: \"BUTTON_ADD_VEHICLE\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 45\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 33\n    }\n  })))))));\n}\nexport default Search;","map":{"version":3,"sources":["C:/Users/Shbaita Studio/Documents/project/new1/themeforest-irsnufCS-redparts-auto-parts-react-ecommerce-template/Sources/src/components/header/Search.tsx"],"names":["React","useRef","useState","FormattedMessage","useIntl","classNames","AppImage","AppLink","AsyncAction","CurrencyFormat","RadioButton","Rating","url","VehicleForm","Car20Svg","RecycleBin16Svg","Search20Svg","shopApi","useGlobalMousedown","useGarageAddItem","useGarageCurrent","useGarageRemoveItem","useGarageSetCurrent","useUserVehicles","Search","intl","query","setQuery","suggestionsIsOpen","setSuggestionsIsOpen","hasSuggestions","setHasSuggestions","products","setProducts","categories","setCategories","vehiclePickerIsOpen","setVehiclePickerIsOpen","vehiclePanel","setVehiclePanel","addVehicle","setAddVehicle","vehicles","garageAddItem","garageRemoveItem","hasVehicles","length","selectVehicleButtonRef","vehiclePickerDropdownRef","currentVehicle","garageSetCurrent","searchCancelFnRef","rootRef","search","value","current","canceled","getSearchSuggestions","limitProducts","limitCategories","then","result","toggleSuggestions","force","prevState","newState","undefined","toggleVehiclePicker","handleInputFocus","event","input","currentTarget","handleInputChange","handleButtonClick","handleChangeCurrentVehicle","vehicleId","parseFloat","handleVehicleChange","vehicle","handleRootBlur","setTimeout","document","activeElement","body","closest","outsideButton","contains","target","outsideDropdown","outside","searchPlaceholder","formatMessage","id","map","product","images","name","rating","reviews","price","category","index","year","make","model","engine","run","loading","preventDefault","Promise","resolve"],"mappings":"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","sourcesContent":["// react\nimport React, { useRef, useState } from 'react';\n// third-party\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport classNames from 'classnames';\n// application\nimport AppImage from '~/components/shared/AppImage';\nimport AppLink from '~/components/shared/AppLink';\nimport AsyncAction from '~/components/shared/AsyncAction';\nimport CurrencyFormat from '~/components/shared/CurrencyFormat';\nimport RadioButton from '~/components/shared/RadioButton';\nimport Rating from '~/components/shared/Rating';\nimport url from '~/services/url';\nimport VehicleForm from '~/components/shared/VehicleForm';\nimport { Car20Svg, RecycleBin16Svg, Search20Svg } from '~/svg';\nimport { IProduct } from '~/interfaces/product';\nimport { IShopCategory } from '~/interfaces/category';\nimport { IVehicle } from '~/interfaces/vehicle';\nimport { shopApi } from '~/api';\nimport { useGlobalMousedown } from '~/services/hooks';\nimport {\n    useGarageAddItem,\n    useGarageCurrent,\n    useGarageRemoveItem,\n    useGarageSetCurrent,\n    useUserVehicles,\n} from '~/store/garage/garageHooks';\n\nexport function Search() {\n    const intl = useIntl();\n    const [query, setQuery] = useState('');\n    const [suggestionsIsOpen, setSuggestionsIsOpen] = useState(false);\n    const [hasSuggestions, setHasSuggestions] = useState(false);\n    const [products, setProducts] = useState<IProduct[]>([]);\n    const [categories, setCategories] = useState<IShopCategory[]>([]);\n    const [vehiclePickerIsOpen, setVehiclePickerIsOpen] = useState(false);\n    const [vehiclePanel, setVehiclePanel] = useState('list');\n    const [addVehicle, setAddVehicle] = useState<IVehicle | null>(null);\n    const vehicles = useUserVehicles();\n    const garageAddItem = useGarageAddItem();\n    const garageRemoveItem = useGarageRemoveItem();\n    const hasVehicles = vehicles.length > 0;\n    const selectVehicleButtonRef = useRef<HTMLButtonElement>(null);\n    const vehiclePickerDropdownRef = useRef<HTMLDivElement>(null);\n\n    const currentVehicle = useGarageCurrent();\n    const garageSetCurrent = useGarageSetCurrent();\n\n    const searchCancelFnRef = useRef(() => {});\n    const rootRef = useRef<HTMLDivElement>(null);\n\n    const search = (value: string) => {\n        searchCancelFnRef.current();\n\n        let canceled = false;\n\n        searchCancelFnRef.current = () => {\n            canceled = true;\n        };\n\n        shopApi.getSearchSuggestions(value, {\n            limitProducts: 3,\n            limitCategories: 4,\n        }).then((result) => {\n            if (canceled) {\n                return;\n            }\n\n            if (result.products.length === 0 && result.categories.length === 0) {\n                setHasSuggestions(false);\n                return;\n            }\n\n            setHasSuggestions(true);\n            setProducts(result.products);\n            setCategories(result.categories);\n        });\n\n        setQuery(value);\n    };\n\n    const toggleSuggestions = (force?: boolean) => {\n        setSuggestionsIsOpen((prevState) => {\n            const newState = force !== undefined ? force : !prevState;\n\n            if (newState) {\n                setVehiclePickerIsOpen(false);\n            }\n\n            return newState;\n        });\n    };\n\n    const toggleVehiclePicker = (force?: boolean): void => {\n        setVehiclePickerIsOpen((prevState) => {\n            const newState = force !== undefined ? force : !prevState;\n\n            if (newState) {\n                setSuggestionsIsOpen(false);\n            }\n\n            return newState;\n        });\n    };\n\n    const handleInputFocus = (event: React.FocusEvent<HTMLInputElement>) => {\n        const input = event.currentTarget;\n\n        toggleSuggestions(true);\n        search(input.value);\n    };\n\n    const handleInputChange = (event: React.FormEvent<HTMLInputElement>) => {\n        const input = event.currentTarget;\n\n        search(input.value);\n    };\n\n    const handleButtonClick = () => {\n        toggleVehiclePicker();\n    };\n\n    const handleChangeCurrentVehicle = (event: React.FormEvent<HTMLInputElement>) => {\n        const vehicleId = event.currentTarget.value === '' ? null : parseFloat(event.currentTarget.value);\n\n        garageSetCurrent(vehicleId);\n    };\n\n    const handleVehicleChange = (vehicle: IVehicle | null) => {\n        setAddVehicle(vehicle);\n    };\n\n    const handleRootBlur = () => {\n        setTimeout(() => {\n            if (document.activeElement === document.body) {\n                return;\n            }\n\n            // Close suggestions if the focus received an external element.\n            if (document.activeElement && document.activeElement.closest('.search') !== rootRef.current) {\n                toggleSuggestions(false);\n            }\n        }, 10);\n    };\n\n    useGlobalMousedown((event) => {\n        const outsideButton = (\n            selectVehicleButtonRef.current\n            && !selectVehicleButtonRef.current.contains(event.target as HTMLElement)\n        );\n        const outsideDropdown = (\n            vehiclePickerDropdownRef.current\n            && !vehiclePickerDropdownRef.current.contains(event.target as HTMLElement)\n        );\n\n        if (outsideButton && outsideDropdown) {\n            setVehiclePickerIsOpen(false);\n        }\n    }, [setVehiclePickerIsOpen, selectVehicleButtonRef]);\n\n    useGlobalMousedown((event) => {\n        const outside = (\n            rootRef.current\n            && !rootRef.current.contains(event.target as HTMLElement)\n        );\n\n        if (outside && suggestionsIsOpen) {\n            setHasSuggestions(false);\n        }\n    }, [rootRef, suggestionsIsOpen, setHasSuggestions]);\n\n    const searchPlaceholder = currentVehicle\n        ? intl.formatMessage({ id: 'INPUT_SEARCH_PLACEHOLDER_VEHICLE' }, currentVehicle as Enumerable<IVehicle>)\n        : intl.formatMessage({ id: 'INPUT_SEARCH_PLACEHOLDER' });\n\n    return (\n        <div className=\"search\" ref={rootRef} onBlur={handleRootBlur}>\n            <form className=\"search__body\">\n                <div className=\"search__shadow\" />\n\n                <label className=\"sr-only\" htmlFor=\"site-search\">\n                    <FormattedMessage id=\"INPUT_SEARCH_LABEL\" />\n                </label>\n\n                <input\n                    type=\"text\"\n                    className=\"search__input\"\n                    id=\"site-search\"\n                    autoCapitalize=\"off\"\n                    autoComplete=\"off\"\n                    spellCheck=\"false\"\n                    name=\"search\"\n                    value={query}\n                    placeholder={searchPlaceholder}\n                    onFocus={handleInputFocus}\n                    onChange={handleInputChange}\n                />\n\n                <button\n                    type=\"button\"\n                    className={classNames('search__button search__button--start', {\n                        'search__button--hover': vehiclePickerIsOpen,\n                    })}\n                    onClick={handleButtonClick}\n                    ref={selectVehicleButtonRef}\n                >\n                    <span className=\"search__button-icon\">\n                        <Car20Svg />\n                    </span>\n                    <span className=\"search__button-title\">\n                        <FormattedMessage id=\"BUTTON_SEARCH_SELECT_VEHICLE_DESKTOP\" />\n                    </span>\n                </button>\n\n                <button className=\"search__button search__button--end\" type=\"submit\">\n                    <span className=\"search__button-icon\">\n                        <Search20Svg />\n                    </span>\n                </button>\n\n                <div className=\"search__box\" />\n                <div className=\"search__decor\">\n                    <div className=\"search__decor-start\" />\n                    <div className=\"search__decor-end\" />\n                </div>\n\n                <div\n                    className={classNames('search__dropdown', 'search__dropdown--suggestions', 'suggestions', {\n                        'search__dropdown--open': suggestionsIsOpen && hasSuggestions,\n                    })}\n                >\n                    {products.length > 0 && (\n                        <div className=\"suggestions__group\">\n                            <div className=\"suggestions__group-title\">\n                                <FormattedMessage id=\"TEXT_PRODUCTS\" />\n                            </div>\n                            <div className=\"suggestions__group-content\">\n                                {products.map((product) => (\n                                    <AppLink\n                                        key={product.id}\n                                        href={url.product(product)}\n                                        className=\"suggestions__item suggestions__product\"\n                                        onClick={() => toggleSuggestions(false)}\n                                    >\n                                        <div className=\"suggestions__product-image\">\n                                            <AppImage src={product.images && product.images[0]} />\n                                        </div>\n                                        <div className=\"suggestions__product-info\">\n                                            <div className=\"suggestions__product-name\">\n                                                {product.name}\n                                            </div>\n                                            <div className=\"suggestions__product-rating\">\n                                                <div className=\"suggestions__product-rating-stars\">\n                                                    <Rating value={product.rating || 0} />\n                                                </div>\n                                                <div className=\"suggestions__product-rating-label\">\n                                                    <FormattedMessage\n                                                        id=\"TEXT_RATING_LABEL\"\n                                                        values={{\n                                                            rating: product.rating,\n                                                            reviews: product.reviews,\n                                                        }}\n                                                    />\n                                                </div>\n                                            </div>\n                                        </div>\n                                        <div className=\" suggestions__product-price\">\n                                            <CurrencyFormat value={product.price} />\n                                        </div>\n\n                                    </AppLink>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n                    {categories.length > 0 && (\n                        <div className=\"suggestions__group\">\n                            <div className=\"suggestions__group-title\">\n                                <FormattedMessage id=\"TEXT_CATEGORIES\" />\n                            </div>\n                            <div className=\"suggestions__group-content\">\n                                {categories.map((category) => (\n                                    <AppLink\n                                        key={category.id}\n                                        href={url.category(category)}\n                                        className=\"suggestions__item suggestions__category\"\n                                        onClick={() => toggleSuggestions(false)}\n                                    >\n                                        {category.name}\n                                    </AppLink>\n                                ))}\n                            </div>\n                        </div>\n                    )}\n                </div>\n\n                <div\n                    className={classNames('search__dropdown', 'search__dropdown--vehicle-picker', 'vehicle-picker', {\n                        'search__dropdown--open': vehiclePickerIsOpen,\n                    })}\n                    ref={vehiclePickerDropdownRef}\n                >\n                    <div className=\"search__dropdown-arrow\" />\n\n                    <div\n                        className={classNames('vehicle-picker__panel', {\n                            'vehicle-picker__panel--active': vehiclePanel === 'list' && hasVehicles,\n                        })}\n                    >\n                        <div className=\"vehicle-picker__panel-body\">\n                            <div className=\"vehicle-picker__text\">\n                                <FormattedMessage id=\"TEXT_SELECT_VEHICLE_TO_FIND_EXACT_FIT_PARTS\" />\n                            </div>\n\n                            <div className=\"vehicles-list\">\n                                <div className=\"vehicles-list__body\">\n                                    {/* eslint-disable-next-line jsx-a11y/label-has-associated-control */}\n                                    <label className=\"vehicles-list__item\">\n                                        <RadioButton\n                                            className=\"vehicles-list__item-radio\"\n                                            name=\"header-current-vehicle\"\n                                            defaultValue=\"\"\n                                            checked={currentVehicle === null}\n                                            onChange={handleChangeCurrentVehicle}\n                                        />\n                                        <span className=\" vehicles-list__item-info\">\n                                            <span className=\" vehicles-list__item-name\">\n                                                <FormattedMessage id=\"TEXT_ALL_VEHICLES\" />\n                                            </span>\n                                        </span>\n                                    </label>\n                                    {vehicles.map((vehicle, index) => (\n                                        <React.Fragment key={index}>\n                                            {/* eslint-disable-next-line jsx-a11y/label-has-associated-control */}\n                                            <label className=\"vehicles-list__item\">\n                                                <RadioButton\n                                                    className=\"vehicles-list__item-radio\"\n                                                    name=\"header-current-vehicle\"\n                                                    defaultValue={vehicle.id}\n                                                    checked={currentVehicle?.id === vehicle.id}\n                                                    onChange={handleChangeCurrentVehicle}\n                                                />\n                                                <span className=\"vehicles-list__item-info\">\n                                                    <span className=\"vehicles-list__item-name\">\n                                                        {`${vehicle.year} ${vehicle.make} ${vehicle.model}`}\n                                                    </span>\n                                                    <span className=\"vehicles-list__item-details\">\n                                                        <FormattedMessage\n                                                            id=\"TEXT_VEHICLE_ENGINE\"\n                                                            values={{ engine: vehicle.engine }}\n                                                        />\n                                                    </span>\n                                                </span>\n                                                <AsyncAction\n                                                    action={() => garageRemoveItem(vehicle.id)}\n                                                    render={({ run, loading }) => (\n                                                        <button\n                                                            type=\"button\"\n                                                            className={classNames('vehicles-list__item-remove', {\n                                                                'vehicles-list__item-remove--loading': loading,\n                                                            })}\n                                                            onClick={run}\n                                                        >\n                                                            <RecycleBin16Svg />\n                                                        </button>\n                                                    )}\n                                                />\n                                            </label>\n                                        </React.Fragment>\n                                    ))}\n                                </div>\n                            </div>\n\n                            <div className=\"vehicle-picker__actions\">\n                                <button\n                                    type=\"button\"\n                                    className=\"btn btn-primary btn-sm\"\n                                    onClick={() => setVehiclePanel('form')}\n                                >\n                                    <FormattedMessage id=\"BUTTON_ADD_VEHICLE\" />\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div\n                        className={classNames('vehicle-picker__panel', {\n                            'vehicle-picker__panel--active': vehiclePanel === 'form' || !hasVehicles,\n                        })}\n                    >\n                        <div className=\"vehicle-picker__panel-body\">\n                            <VehicleForm location=\"search\" onVehicleChange={handleVehicleChange} />\n                            <div className=\"vehicle-picker__actions\">\n                                {hasVehicles && (\n                                    <div className=\"search__car-selector-link\">\n                                        {/* eslint-disable-next-line */}\n                                        <AppLink\n                                            anchor\n                                            onClick={(event) => {\n                                                event.preventDefault();\n\n                                                setVehiclePanel('list');\n                                            }}\n                                        >\n                                            <FormattedMessage id=\"BUTTON_BACK_TO_LIST\" />\n                                        </AppLink>\n                                    </div>\n                                )}\n\n                                <AsyncAction\n                                    action={() => (addVehicle ? garageAddItem(addVehicle.id) : Promise.resolve())}\n                                    render={({ run, loading }) => (\n                                        <button\n                                            type=\"button\"\n                                            className={classNames('btn', 'btn-primary', 'btn-sm', {\n                                                'btn-loading': loading,\n                                            })}\n                                            disabled={addVehicle === null}\n                                            onClick={run}\n                                        >\n                                            <FormattedMessage id=\"BUTTON_ADD_VEHICLE\" />\n                                        </button>\n                                    )}\n                                />\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </form>\n        </div>\n    );\n}\n\nexport default Search;\n"]},"metadata":{},"sourceType":"module"}