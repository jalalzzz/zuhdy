{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n// application\nimport { getActiveFilters, getResetValue, hasHandler } from '~/services/filters';\nimport { SHOP_NAMESPACE } from '~/store/shop/shopTypes';\nimport { SHOP_FETCH_CATEGORY_SUCCESS, SHOP_FETCH_PRODUCTS_LIST_START, SHOP_FETCH_PRODUCTS_LIST_SUCCESS, SHOP_HYDRATE, SHOP_INIT, SHOP_RESET_FILTER, SHOP_RESET_FILTERS, SHOP_SET_FILTER_VALUE, SHOP_SET_OPTION_VALUE } from '~/store/shop/shopActionTypes';\nvar initialState = {\n  init: false,\n  categorySlug: null,\n  categoryIsLoading: true,\n  category: null,\n  productsListIsLoading: true,\n  productsList: null,\n  options: {},\n  filters: {},\n  activeFilters: [],\n  removedFilters: [],\n  currentFilters: []\n};\n\nfunction shopReducerFetchProductsListSuccess(state, action) {\n  var activeFilters = action.productsList.filters.filter(function (x) {\n    return hasHandler(x);\n  }).reduce(function (acc, filter) {\n    return [].concat(_toConsumableArray(acc), _toConsumableArray(getActiveFilters(filter)));\n  }, []);\n  return _objectSpread(_objectSpread({}, state), {}, {\n    productsListIsLoading: false,\n    productsList: action.productsList,\n    activeFilters: activeFilters,\n    removedFilters: [],\n    currentFilters: activeFilters\n  });\n}\n\nfunction shopReducerSetFilterValue(state, action) {\n  var currentFilters = _objectSpread({}, state.filters);\n\n  var filters;\n\n  if (action.value !== null) {\n    filters = _objectSpread(_objectSpread({}, currentFilters), {}, _defineProperty({}, action.filter, action.value));\n  } else {\n    delete currentFilters[action.filter];\n    filters = _objectSpread({}, currentFilters);\n  }\n\n  return _objectSpread(_objectSpread({}, state), {}, {\n    options: _objectSpread(_objectSpread({}, state.options), {}, {\n      page: 1\n    }),\n    filters: filters\n  });\n}\n\nfunction shopReducerResetFilter(state, action) {\n  if (!hasHandler(action.activeFilter.original)) {\n    return state;\n  }\n\n  var removedFilters = state.removedFilters;\n\n  if (!removedFilters.includes(action.activeFilter)) {\n    removedFilters = [].concat(_toConsumableArray(removedFilters), [action.activeFilter]);\n  }\n\n  var currentFilters = state.currentFilters;\n\n  if (currentFilters.includes(action.activeFilter)) {\n    currentFilters = currentFilters.filter(function (x) {\n      return x !== action.activeFilter;\n    });\n  } // All removed filters with the same slug.\n\n\n  var all = removedFilters.filter(function (x) {\n    return x.original.slug === action.activeFilter.original.slug;\n  });\n  var value = getResetValue(all); // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n  var _state$filters = state.filters,\n      _action$activeFilter$ = action.activeFilter.original.slug,\n      _ = _state$filters[_action$activeFilter$],\n      filters = _objectWithoutProperties(_state$filters, [_action$activeFilter$].map(_toPropertyKey));\n\n  if (value !== null) {\n    filters[action.activeFilter.original.slug] = value;\n  }\n\n  return _objectSpread(_objectSpread({}, state), {}, {\n    options: _objectSpread(_objectSpread({}, state.options), {}, {\n      page: 1\n    }),\n    filters: filters,\n    removedFilters: removedFilters,\n    currentFilters: currentFilters\n  });\n}\n\nfunction shopReducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case SHOP_HYDRATE:\n      return action.payload[SHOP_NAMESPACE];\n\n    case SHOP_INIT:\n      return _objectSpread(_objectSpread({}, initialState), {}, {\n        categorySlug: action.categorySlug,\n        options: action.options,\n        filters: action.filters\n      });\n\n    case SHOP_FETCH_CATEGORY_SUCCESS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        init: true,\n        categoryIsLoading: false,\n        category: action.category\n      });\n\n    case SHOP_FETCH_PRODUCTS_LIST_START:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        productsListIsLoading: true\n      });\n\n    case SHOP_FETCH_PRODUCTS_LIST_SUCCESS:\n      return shopReducerFetchProductsListSuccess(state, action);\n\n    case SHOP_SET_OPTION_VALUE:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        options: _objectSpread(_objectSpread({}, state.options), {}, _defineProperty({\n          page: 1\n        }, action.option, action.value))\n      });\n\n    case SHOP_SET_FILTER_VALUE:\n      return shopReducerSetFilterValue(state, action);\n\n    case SHOP_RESET_FILTERS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        options: _objectSpread(_objectSpread({}, state.options), {}, {\n          page: 1\n        }),\n        filters: {}\n      });\n\n    case SHOP_RESET_FILTER:\n      return shopReducerResetFilter(state, action);\n\n    default:\n      return state;\n  }\n}\n\nexport default shopReducer;","map":{"version":3,"sources":["C:/Users/Shbaita Studio/Documents/project/new1/themeforest-irsnufCS-redparts-auto-parts-react-ecommerce-template/Sources/src/store/shop/shopReducer.ts"],"names":["getActiveFilters","getResetValue","hasHandler","SHOP_NAMESPACE","SHOP_FETCH_CATEGORY_SUCCESS","SHOP_FETCH_PRODUCTS_LIST_START","SHOP_FETCH_PRODUCTS_LIST_SUCCESS","SHOP_HYDRATE","SHOP_INIT","SHOP_RESET_FILTER","SHOP_RESET_FILTERS","SHOP_SET_FILTER_VALUE","SHOP_SET_OPTION_VALUE","initialState","init","categorySlug","categoryIsLoading","category","productsListIsLoading","productsList","options","filters","activeFilters","removedFilters","currentFilters","shopReducerFetchProductsListSuccess","state","action","filter","x","reduce","acc","shopReducerSetFilterValue","value","page","shopReducerResetFilter","activeFilter","original","includes","all","slug","_","shopReducer","type","payload","option"],"mappings":"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","sourcesContent":["// application\nimport { getActiveFilters, getResetValue, hasHandler } from '~/services/filters';\nimport { IActiveFilter } from '~/interfaces/filter';\nimport { IFilterValues } from '~/interfaces/list';\nimport { SHOP_NAMESPACE, IShopState } from '~/store/shop/shopTypes';\nimport {\n    SHOP_FETCH_CATEGORY_SUCCESS,\n    SHOP_FETCH_PRODUCTS_LIST_START,\n    SHOP_FETCH_PRODUCTS_LIST_SUCCESS,\n    SHOP_HYDRATE,\n    SHOP_INIT, SHOP_RESET_FILTER,\n    SHOP_RESET_FILTERS,\n    SHOP_SET_FILTER_VALUE,\n    SHOP_SET_OPTION_VALUE,\n    ShopAction,\n    ShopFetchProductsListSuccessAction,\n    ShopResetFilterAction,\n    ShopSetFilterValueAction,\n} from '~/store/shop/shopActionTypes';\n\nconst initialState: IShopState = {\n    init: false,\n    categorySlug: null,\n    categoryIsLoading: true,\n    category: null,\n    productsListIsLoading: true,\n    productsList: null,\n    options: {},\n    filters: {},\n    activeFilters: [],\n    removedFilters: [],\n    currentFilters: [],\n};\n\nfunction shopReducerFetchProductsListSuccess(\n    state: IShopState,\n    action: ShopFetchProductsListSuccessAction,\n): IShopState {\n    const activeFilters = action.productsList.filters\n        .filter((x) => hasHandler(x))\n        .reduce<IActiveFilter[]>((acc, filter) => [...acc, ...getActiveFilters(filter)], []);\n\n    return {\n        ...state,\n        productsListIsLoading: false,\n        productsList: action.productsList,\n        activeFilters,\n        removedFilters: [],\n        currentFilters: activeFilters,\n    };\n}\n\nfunction shopReducerSetFilterValue(state: IShopState, action: ShopSetFilterValueAction): IShopState {\n    const currentFilters = { ...state.filters };\n    let filters: IFilterValues;\n\n    if (action.value !== null) {\n        filters = { ...currentFilters, [action.filter]: action.value };\n    } else {\n        delete currentFilters[action.filter];\n\n        filters = { ...currentFilters };\n    }\n\n    return {\n        ...state,\n        options: { ...state.options, page: 1 },\n        filters,\n    };\n}\n\nfunction shopReducerResetFilter(state: IShopState, action: ShopResetFilterAction): IShopState {\n    if (!hasHandler(action.activeFilter.original)) {\n        return state;\n    }\n\n    let { removedFilters } = state;\n\n    if (!removedFilters.includes(action.activeFilter)) {\n        removedFilters = [...removedFilters, action.activeFilter];\n    }\n\n    let { currentFilters } = state;\n\n    if (currentFilters.includes(action.activeFilter)) {\n        currentFilters = currentFilters.filter((x) => x !== action.activeFilter);\n    }\n\n    // All removed filters with the same slug.\n    const all = removedFilters.filter((x) => x.original.slug === action.activeFilter.original.slug);\n    const value = getResetValue(all);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const { [action.activeFilter.original.slug]: _, ...filters } = state.filters;\n\n    if (value !== null) {\n        filters[action.activeFilter.original.slug] = value;\n    }\n\n    return {\n        ...state,\n        options: {\n            ...state.options,\n            page: 1,\n        },\n        filters,\n        removedFilters,\n        currentFilters,\n    };\n}\n\nfunction shopReducer(state = initialState, action: ShopAction): IShopState {\n    switch (action.type) {\n    case SHOP_HYDRATE:\n        return action.payload[SHOP_NAMESPACE];\n    case SHOP_INIT:\n        return {\n            ...initialState,\n            categorySlug: action.categorySlug,\n            options: action.options,\n            filters: action.filters,\n        };\n    case SHOP_FETCH_CATEGORY_SUCCESS:\n        return {\n            ...state,\n            init: true,\n            categoryIsLoading: false,\n            category: action.category,\n        };\n    case SHOP_FETCH_PRODUCTS_LIST_START:\n        return { ...state, productsListIsLoading: true };\n    case SHOP_FETCH_PRODUCTS_LIST_SUCCESS:\n        return shopReducerFetchProductsListSuccess(state, action);\n    case SHOP_SET_OPTION_VALUE:\n        return {\n            ...state,\n            options: { ...state.options, page: 1, [action.option]: action.value },\n        };\n    case SHOP_SET_FILTER_VALUE: return shopReducerSetFilterValue(state, action);\n    case SHOP_RESET_FILTERS:\n        return { ...state, options: { ...state.options, page: 1 }, filters: {} };\n    case SHOP_RESET_FILTER:\n        return shopReducerResetFilter(state, action);\n    default:\n        return state;\n    }\n}\n\nexport default shopReducer;\n"]},"metadata":{},"sourceType":"module"}