{"ast":null,"code":"function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// application\nimport { getActiveFilters, getResetValue, hasHandler } from '~/services/filters';\nimport { SHOP_NAMESPACE } from '~/store/shop/shopTypes';\nimport { SHOP_FETCH_CATEGORY_SUCCESS, SHOP_FETCH_PRODUCTS_LIST_START, SHOP_FETCH_PRODUCTS_LIST_SUCCESS, SHOP_HYDRATE, SHOP_INIT, SHOP_RESET_FILTER, SHOP_RESET_FILTERS, SHOP_SET_FILTER_VALUE, SHOP_SET_OPTION_VALUE } from '~/store/shop/shopActionTypes';\nconst initialState = {\n  init: false,\n  categorySlug: null,\n  categoryIsLoading: true,\n  category: null,\n  productsListIsLoading: true,\n  productsList: null,\n  options: {},\n  filters: {},\n  activeFilters: [],\n  removedFilters: [],\n  currentFilters: []\n};\n\nfunction shopReducerFetchProductsListSuccess(state, action) {\n  const activeFilters = action.productsList.filters.filter(x => hasHandler(x)).reduce((acc, filter) => [...acc, ...getActiveFilters(filter)], []);\n  return _objectSpread(_objectSpread({}, state), {}, {\n    productsListIsLoading: false,\n    productsList: action.productsList,\n    activeFilters,\n    removedFilters: [],\n    currentFilters: activeFilters\n  });\n}\n\nfunction shopReducerSetFilterValue(state, action) {\n  const currentFilters = _objectSpread({}, state.filters);\n\n  let filters;\n\n  if (action.value !== null) {\n    filters = _objectSpread(_objectSpread({}, currentFilters), {}, {\n      [action.filter]: action.value\n    });\n  } else {\n    delete currentFilters[action.filter];\n    filters = _objectSpread({}, currentFilters);\n  }\n\n  return _objectSpread(_objectSpread({}, state), {}, {\n    options: _objectSpread(_objectSpread({}, state.options), {}, {\n      page: 1\n    }),\n    filters\n  });\n}\n\nfunction shopReducerResetFilter(state, action) {\n  if (!hasHandler(action.activeFilter.original)) {\n    return state;\n  }\n\n  let {\n    removedFilters\n  } = state;\n\n  if (!removedFilters.includes(action.activeFilter)) {\n    removedFilters = [...removedFilters, action.activeFilter];\n  }\n\n  let {\n    currentFilters\n  } = state;\n\n  if (currentFilters.includes(action.activeFilter)) {\n    currentFilters = currentFilters.filter(x => x !== action.activeFilter);\n  } // All removed filters with the same slug.\n\n\n  const all = removedFilters.filter(x => x.original.slug === action.activeFilter.original.slug);\n  const value = getResetValue(all); // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n  const _state$filters = state.filters,\n        _action$activeFilter$ = action.activeFilter.original.slug,\n        {\n    [_action$activeFilter$]: _\n  } = _state$filters,\n        filters = _objectWithoutProperties(_state$filters, [_action$activeFilter$].map(_toPropertyKey));\n\n  if (value !== null) {\n    filters[action.activeFilter.original.slug] = value;\n  }\n\n  return _objectSpread(_objectSpread({}, state), {}, {\n    options: _objectSpread(_objectSpread({}, state.options), {}, {\n      page: 1\n    }),\n    filters,\n    removedFilters,\n    currentFilters\n  });\n}\n\nfunction shopReducer(state = initialState, action) {\n  switch (action.type) {\n    case SHOP_HYDRATE:\n      return action.payload[SHOP_NAMESPACE];\n\n    case SHOP_INIT:\n      return _objectSpread(_objectSpread({}, initialState), {}, {\n        categorySlug: action.categorySlug,\n        options: action.options,\n        filters: action.filters\n      });\n\n    case SHOP_FETCH_CATEGORY_SUCCESS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        init: true,\n        categoryIsLoading: false,\n        category: action.category\n      });\n\n    case SHOP_FETCH_PRODUCTS_LIST_START:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        productsListIsLoading: true\n      });\n\n    case SHOP_FETCH_PRODUCTS_LIST_SUCCESS:\n      return shopReducerFetchProductsListSuccess(state, action);\n\n    case SHOP_SET_OPTION_VALUE:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        options: _objectSpread(_objectSpread({}, state.options), {}, {\n          page: 1,\n          [action.option]: action.value\n        })\n      });\n\n    case SHOP_SET_FILTER_VALUE:\n      return shopReducerSetFilterValue(state, action);\n\n    case SHOP_RESET_FILTERS:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        options: _objectSpread(_objectSpread({}, state.options), {}, {\n          page: 1\n        }),\n        filters: {}\n      });\n\n    case SHOP_RESET_FILTER:\n      return shopReducerResetFilter(state, action);\n\n    default:\n      return state;\n  }\n}\n\nexport default shopReducer;","map":{"version":3,"sources":["C:/Users/Shbaita Studio/Documents/project/new1/themeforest-irsnufCS-redparts-auto-parts-react-ecommerce-template/Sources/src/store/shop/shopReducer.ts"],"names":["getActiveFilters","getResetValue","hasHandler","SHOP_NAMESPACE","SHOP_FETCH_CATEGORY_SUCCESS","SHOP_FETCH_PRODUCTS_LIST_START","SHOP_FETCH_PRODUCTS_LIST_SUCCESS","SHOP_HYDRATE","SHOP_INIT","SHOP_RESET_FILTER","SHOP_RESET_FILTERS","SHOP_SET_FILTER_VALUE","SHOP_SET_OPTION_VALUE","initialState","init","categorySlug","categoryIsLoading","category","productsListIsLoading","productsList","options","filters","activeFilters","removedFilters","currentFilters","shopReducerFetchProductsListSuccess","state","action","filter","x","reduce","acc","shopReducerSetFilterValue","value","page","shopReducerResetFilter","activeFilter","original","includes","all","slug","_","shopReducer","type","payload","option"],"mappings":"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","sourcesContent":["// application\nimport { getActiveFilters, getResetValue, hasHandler } from '~/services/filters';\nimport { IActiveFilter } from '~/interfaces/filter';\nimport { IFilterValues } from '~/interfaces/list';\nimport { SHOP_NAMESPACE, IShopState } from '~/store/shop/shopTypes';\nimport {\n    SHOP_FETCH_CATEGORY_SUCCESS,\n    SHOP_FETCH_PRODUCTS_LIST_START,\n    SHOP_FETCH_PRODUCTS_LIST_SUCCESS,\n    SHOP_HYDRATE,\n    SHOP_INIT, SHOP_RESET_FILTER,\n    SHOP_RESET_FILTERS,\n    SHOP_SET_FILTER_VALUE,\n    SHOP_SET_OPTION_VALUE,\n    ShopAction,\n    ShopFetchProductsListSuccessAction,\n    ShopResetFilterAction,\n    ShopSetFilterValueAction,\n} from '~/store/shop/shopActionTypes';\n\nconst initialState: IShopState = {\n    init: false,\n    categorySlug: null,\n    categoryIsLoading: true,\n    category: null,\n    productsListIsLoading: true,\n    productsList: null,\n    options: {},\n    filters: {},\n    activeFilters: [],\n    removedFilters: [],\n    currentFilters: [],\n};\n\nfunction shopReducerFetchProductsListSuccess(\n    state: IShopState,\n    action: ShopFetchProductsListSuccessAction,\n): IShopState {\n    const activeFilters = action.productsList.filters\n        .filter((x) => hasHandler(x))\n        .reduce<IActiveFilter[]>((acc, filter) => [...acc, ...getActiveFilters(filter)], []);\n\n    return {\n        ...state,\n        productsListIsLoading: false,\n        productsList: action.productsList,\n        activeFilters,\n        removedFilters: [],\n        currentFilters: activeFilters,\n    };\n}\n\nfunction shopReducerSetFilterValue(state: IShopState, action: ShopSetFilterValueAction): IShopState {\n    const currentFilters = { ...state.filters };\n    let filters: IFilterValues;\n\n    if (action.value !== null) {\n        filters = { ...currentFilters, [action.filter]: action.value };\n    } else {\n        delete currentFilters[action.filter];\n\n        filters = { ...currentFilters };\n    }\n\n    return {\n        ...state,\n        options: { ...state.options, page: 1 },\n        filters,\n    };\n}\n\nfunction shopReducerResetFilter(state: IShopState, action: ShopResetFilterAction): IShopState {\n    if (!hasHandler(action.activeFilter.original)) {\n        return state;\n    }\n\n    let { removedFilters } = state;\n\n    if (!removedFilters.includes(action.activeFilter)) {\n        removedFilters = [...removedFilters, action.activeFilter];\n    }\n\n    let { currentFilters } = state;\n\n    if (currentFilters.includes(action.activeFilter)) {\n        currentFilters = currentFilters.filter((x) => x !== action.activeFilter);\n    }\n\n    // All removed filters with the same slug.\n    const all = removedFilters.filter((x) => x.original.slug === action.activeFilter.original.slug);\n    const value = getResetValue(all);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const { [action.activeFilter.original.slug]: _, ...filters } = state.filters;\n\n    if (value !== null) {\n        filters[action.activeFilter.original.slug] = value;\n    }\n\n    return {\n        ...state,\n        options: {\n            ...state.options,\n            page: 1,\n        },\n        filters,\n        removedFilters,\n        currentFilters,\n    };\n}\n\nfunction shopReducer(state = initialState, action: ShopAction): IShopState {\n    switch (action.type) {\n    case SHOP_HYDRATE:\n        return action.payload[SHOP_NAMESPACE];\n    case SHOP_INIT:\n        return {\n            ...initialState,\n            categorySlug: action.categorySlug,\n            options: action.options,\n            filters: action.filters,\n        };\n    case SHOP_FETCH_CATEGORY_SUCCESS:\n        return {\n            ...state,\n            init: true,\n            categoryIsLoading: false,\n            category: action.category,\n        };\n    case SHOP_FETCH_PRODUCTS_LIST_START:\n        return { ...state, productsListIsLoading: true };\n    case SHOP_FETCH_PRODUCTS_LIST_SUCCESS:\n        return shopReducerFetchProductsListSuccess(state, action);\n    case SHOP_SET_OPTION_VALUE:\n        return {\n            ...state,\n            options: { ...state.options, page: 1, [action.option]: action.value },\n        };\n    case SHOP_SET_FILTER_VALUE: return shopReducerSetFilterValue(state, action);\n    case SHOP_RESET_FILTERS:\n        return { ...state, options: { ...state.options, page: 1 }, filters: {} };\n    case SHOP_RESET_FILTER:\n        return shopReducerResetFilter(state, action);\n    default:\n        return state;\n    }\n}\n\nexport default shopReducer;\n"]},"metadata":{},"sourceType":"module"}