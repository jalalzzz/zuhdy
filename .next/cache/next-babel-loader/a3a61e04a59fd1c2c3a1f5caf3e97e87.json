{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// application\nimport { CategoryFilterBuilder } from '~/fake-server/filters/category-filter-builder';\nimport { CheckFilterBuilder } from '~/fake-server/filters/check-filter-builder';\nimport { clone, delayResponse, error } from '~/fake-server/utils';\nimport { ColorFilterBuilder } from '~/fake-server/filters/color-filter-builder';\nimport { getNextReviewId, reviews } from '~/fake-server/database/reviews';\nimport { prepareCategory } from '~/fake-server/endpoints/categories';\nimport { products as dbProducts } from '~/fake-server/database/products';\nimport { RadioFilterBuilder } from '~/fake-server/filters/radio-filter-builder';\nimport { RangeFilterBuilder } from '~/fake-server/filters/range-filter-builder';\nimport { RatingFilterBuilder } from '~/fake-server/filters/rating-filter-builder';\nimport { shopCategoriesList } from '~/fake-server/database/categories';\nimport { VehicleFilterBuilder } from '~/fake-server/filters/vehicle-filter-builder';\n\nfunction getProducts(shift, categorySlug = null) {\n  let shiftValue = shift;\n\n  switch (categorySlug) {\n    case 'tires-wheels':\n    case 'power-tools':\n      shiftValue += 5;\n      break;\n\n    case 'interior-parts':\n    case 'hand-tools':\n      shiftValue += 10;\n      break;\n\n    case 'engine-drivetrain':\n    case 'plumbing':\n      shiftValue += 15;\n      break;\n\n    default:\n  }\n\n  return [...dbProducts.slice(shiftValue), ...dbProducts.slice(0, shiftValue)];\n}\n\nexport function getProductsList(options = {}, filterValues = {}) {\n  const filters = [new CategoryFilterBuilder('category', 'Categories'), new VehicleFilterBuilder('vehicle', 'Vehicle'), new RangeFilterBuilder('price', 'Price'), new CheckFilterBuilder('brand', 'Brand'), new RadioFilterBuilder('discount', 'With Discount'), new RatingFilterBuilder('rating', 'Rating'), new ColorFilterBuilder('color', 'Color')];\n  let products = dbProducts.slice(0);\n  filters.forEach(filter => filter.makeItems(products, filterValues[filter.slug])); // Calculate items count for filter values.\n\n  filters.forEach(filter => filter.calc(filters)); // Apply filters to products list.\n\n  products = products.filter(product => filters.reduce((mr, filter) => mr && filter.test(product), true));\n  const page = (options === null || options === void 0 ? void 0 : options.page) || 1;\n  const limit = (options === null || options === void 0 ? void 0 : options.limit) || 16;\n  const sort = (options === null || options === void 0 ? void 0 : options.sort) || 'default';\n  const total = products.length;\n  const pages = Math.ceil(products.length / limit);\n  const from = (page - 1) * limit + 1;\n  const to = Math.min(page * limit, total); // Sort items array.\n\n  products = products.sort((a, b) => {\n    if (['name_asc', 'name_desc'].includes(sort)) {\n      if (a.name === b.name) {\n        return 0;\n      }\n\n      return (a.name > b.name ? 1 : -1) * (sort === 'name_asc' ? 1 : -1);\n    }\n\n    return 0;\n  });\n  const items = products.slice(from - 1, to);\n  return delayResponse(Promise.resolve({\n    items,\n    page,\n    limit,\n    sort,\n    total,\n    pages,\n    from,\n    to,\n    filters: filters.map(x => x.build())\n  }), 350);\n}\nexport function getProductBySlug(slug) {\n  const product = dbProducts.find(x => x.slug === slug);\n\n  if (!product) {\n    return error('Page Not Found');\n  }\n\n  return Promise.resolve(clone(product));\n}\nexport function getProductReviews(productId, options) {\n  let items = reviews.slice(0);\n  items.sort((a, b) => {\n    if (a.date > b.date) {\n      return -1;\n    }\n\n    if (a.date < b.date) {\n      return 1;\n    }\n\n    return 0;\n  });\n  const page = (options === null || options === void 0 ? void 0 : options.page) || 1;\n  const limit = (options === null || options === void 0 ? void 0 : options.limit) || 8;\n  const sort = (options === null || options === void 0 ? void 0 : options.sort) || 'default';\n  const total = items.length;\n  const pages = Math.ceil(items.length / limit);\n  const from = (page - 1) * limit + 1;\n  const to = page * limit;\n  items = items.slice(from - 1, to);\n  return Promise.resolve({\n    items,\n    page,\n    limit,\n    sort,\n    total,\n    pages,\n    from,\n    to\n  });\n}\nexport function addProductReview(productId, data) {\n  const review = {\n    id: getNextReviewId(),\n    date: new Date().toISOString().substr(0, 10),\n    author: data.author,\n    avatar: '/images/avatars/avatar-2.jpg',\n    rating: data.rating,\n    content: data.content\n  };\n  reviews.push(review);\n  return delayResponse(Promise.resolve(review));\n} // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\nexport function getProductAnalogs(productId) {\n  const slugs = ['sunset-brake-kit', 'specter-brake-kit', 'brake-kit'];\n  const analogs = dbProducts.filter(x => slugs.includes(x.slug));\n  return Promise.resolve(clone(analogs));\n}\nexport function getRelatedProducts(productId, limit) {\n  return Promise.resolve(clone(dbProducts.slice(0, limit)));\n}\nexport function getFeaturedProducts(categorySlug, limit) {\n  return delayResponse(Promise.resolve(clone(getProducts(0, categorySlug).slice(0, limit))), 1000);\n}\nexport function getPopularProducts(categorySlug, limit) {\n  return delayResponse(Promise.resolve(clone(getProducts(6, categorySlug).slice(0, limit))), 1000);\n}\nexport function getTopRatedProducts(categorySlug, limit) {\n  return delayResponse(Promise.resolve(clone(getProducts(12, categorySlug).slice(0, limit))), 1000);\n}\nexport function getSpecialOffers(limit) {\n  return delayResponse(Promise.resolve(clone(getProducts(8).slice(0, limit))), 1000);\n}\nexport function getLatestProducts(limit) {\n  return Promise.resolve(clone(dbProducts.slice(0, limit)));\n}\nexport function getSearchSuggestions(query, options) {\n  const queryVal = query.toLowerCase();\n\n  const optionsVal = _objectSpread({\n    limitProducts: 4,\n    limitCategories: 4\n  }, options);\n\n  const resultProducts = dbProducts.filter(x => x.name.toLowerCase().includes(queryVal));\n  const resultCategories = shopCategoriesList.filter(x => x.name.toLowerCase().includes(queryVal));\n  return Promise.resolve({\n    products: resultProducts.slice(0, optionsVal.limitProducts),\n    categories: resultCategories.slice(0, optionsVal.limitCategories).map(x => prepareCategory(x))\n  });\n}","map":null,"metadata":{},"sourceType":"module"}